# 🧑‍💻 Get Started (LIGO)

The OCaml based syntax is used for structures and examples written in LIGO. If you are a complete beginner, you may want to start with this [video tutorial](https://www.youtube.com/watch?v=IvZdupLVyGc&t=875s&ab_channel=TZAPAC). You can also read the docs [here](https://ligolang.org/docs/intro/introduction/?lang=cameligo).

The content below explains some of the important concepts around the tooling used, that you must know in order to understand LIGO based structures.

## Folder layout

```
\
 |————— common/ # common utilities used across structures and examples
 .
 |————— contracts/ # smart contracts for the structures
 |————————— metadata/ # TZIP-16 based metadata for the structures
 |————————— michelson/ # compiled michelson
 .
 |————— data/ # utilites for the SVG based structures and examples
 .
 |————— examples/ # smart contracts for the examples
 |————————— metadata/ # TZIP-16 based metadata for the examples
 |————————— michelson/ # compiled michelson
 .
 |————— tests/ # Jest based testing of contracts
```

## Tools required

- [LIGO](https://www.ligolang.org/docs/intro/introduction?lang=cameligo) - Cameligo syntax [version: 0.52.0]
- [Flextesa](https://tezos.gitlab.io/flextesa/) - Tezos sandbox for testing out the contracts [version: oxheadalpha/flextesa:20221123]
- [Docker](https://docs.docker.com/get-started/overview/) - For running flextesa and LIGO images [version: 20.10.14]
- [NodeJS](https://nodejs.org/en/docs/) - For testing [version: 14.17.1]

## Compiling LIGO to Michelson

The structures and examples are compiled and stored in a `/michelson` folder, present in both `/contracts` and `/examples`. To compile a LIGO contract you may run:

```
$ ligo compile contract <file_path> > <michelson_file_path>
```

## Generating off-chain views

Off-chain views are essentially functional expressions in Cameligo that you would need to compile down to Michelson (JSON format). To compile an expression written in Cameligo, you can run:

```
$ ligo compile expression cameligo --init-file <file_path> <expression_identifier> --michelson-format json
```

In the structures and examples given in this repo, the expression for the off-chain view is called `token_metadata`. So, you would always be replacing `<expression_identifier>` in the command with `token_metadata`.

The Michelson received by compiling the expression would only be the `code` field of the [Michelson storage view](https://gitlab.com/tezos/tzip/-/blob/master/proposals/tzip-16/tzip-16.md#michelson-storage-views). You would still need to manually create the entire view (and the subsequent TZIp-16 metadata JSON) by adding `parameter` and `returnType` fields.

For reference, here a complete view for Create structure: https://github.com/AnshuJalan/tezos-dNFT/blob/master/ligo/contracts/metadata/create.json#L12

## Testing LIGO contracts

We essentially test the Michelson generated by compiling the LIGO code. The Michelson is deployed on flextesa sandbox using Taquito and and tested using a suite created through [Jest](https://jestjs.io/docs/getting-started).

We essentially have a node project for the tests. You can install the node dependencies by running this in the root LIGO folder:

```
$ npm install
```

After the dependencies are installed, run the flextesa sandbox through:

```
$ npm run flextesa
```

There are two test suites. One for the structure and another for the examples. You must run the test suites separately in order to prevent a counter error by pushing two manager operations in one block.

For structures:

```
$ npm test contract
```

For examples:

```
$ npm test example
```
